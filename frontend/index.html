<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>表单提交到 Google 表格</title>
  <style>
    label { display: block; margin: 4px 0; }
  </style>
</head>
<body>
  <h2>订阅表单</h2>
  <form id="sheetForm">
    <label>姓名：<input name="name" required /></label>
    <label>邮箱：<input name="email" type="email" required /></label>
    <label>兴趣：<input name="interest" /></label>
    <label>位置：<input name="location" /></label>
    <label><input name="newsletter" type="checkbox" /> 订阅电子报</label>
    <button type="submit">提交</button>
  </form>

  <script>
    const endpoint = 'https://script.google.com/macros/s/AKfycbwxNgMhlUQkSJqeNAyRB-xrwjO25lH-qMJ3AasuEUJu4gR4cD8QS357BgCZVVadxHPL4Q/exec'; // Example URL, use your own!

    document.getElementById('sheetForm').addEventListener('submit', async evt => {
      evt.preventDefault();
      const fd = new FormData(evt.target);
      const data = Object.fromEntries(fd);
      data.newsletter = fd.has('newsletter');

      const params = new URLSearchParams(data);

      const res = await fetch(endpoint, {
        method: 'POST',
        body: params
        });

      const result = await res.json();
      if (result.status === 'ok') {
        alert('提交成功！');
        evt.target.reset();
      } else {
        alert('提交失败，请重试。');
      }
    });
  </script>
</body>
</html>